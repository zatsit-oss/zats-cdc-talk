# zats-cdc-talk
Project to illustrate the CDC talk

## Getting Started

This project includes a full-stack application with a Kafka Connect stack, a frontend, and a backend. You can use the provided `Makefile` to manage and start the services easily.

### Prerequisites

Ensure you have the following installed on your system:
- Docker and Docker Compose
- Node.js and npm

### Available Commands

The `Makefile` provides the following commands:

- **Start Kafka Connect stack:**
  ```bash
  make connect
  ```
  This command starts the Kafka Connect stack using the `kafka/full-stack.yml` file.

- **Start Ngrok:**
  ```bash
  make ngrok
  ```
  This command starts Ngrok service to proxy frontend, backend and kafka REST proxy. You need to modify [ngrok.yml](./ngrok.yml) before, to put your Ngrok Auth Token.

- **Get URLs generated by Ngrok**
  ```bash
  make get-ngrok-urls
  ```
  This command create a new file `.env.ngrok.generated` and query Ngrok services to get URLs generated for frontend, backend and Kafka REST Proxy. Also, this command put these URL into environment variables:
  - Frontend side:
    - VITE_SOCKET_URL: backend URL for Websocket communication
    - VITE_KAFKA_PROXY_URL: Kafka REST Proxy for Kafka Producer
  - Backend side:
    - FRONTEND_URL

- **Start Frontend:**
  ```bash
  make frontend
  ```
  This command starts the frontend development server. You need to install deps with `npm i` before run this

- **Start Backend:**
  ```bash
  make backend
  ```
  This command starts the backend development server. You need to install deps with `npm i` before run this

- **Start All Services:**
  ```bash
  make start
  ```
  This command starts the Kafka Connect stack, ngrok, backend and frontend with ngrok exposed urls.

- **Stop All Services:**
  ```bash
  make stop
  ```
  This command stops all running containers (connect).


### How to configure Kafka Connect and create a Postgresql connector ?

Kafka Connect is already available with the provided docker-compose file. You just need to run make start.

#### How to add a Postgresql connector

TODO Quentin: Setup la Database avant sinon la task failed: io.debezium.DebeziumException: Creation of replication slot failed

You have two choices to achieve this.

1. With Conduktor Console

- Go to the Conduktor Console, by default http://localhost:8080
- Go to "Kafka Connect" on left menu
- Click on "full stack kafka connect"
- Click on "Add connector" on the top right corner
- Choose "Postgres Connector"
- Fill informations on "Postgres" form:
  - Topic prefix: pokesky
  - Hostname: postgresql-pokesky
  - Port: 5432
  - User: pikachu
  - Password: zatsit
  - Database: pokesky
- Give a name for your connector (on the top)
- Click on Next
- Review your config and click on Submit
- And ðŸŽ‰


### Notes

- Ensure that the `docker-compose` command is available in your terminal.
- The frontend and backend directories are located under the `package/` folder.
- Modify the `Makefile` if your directory structure or requirements differ.
- To kill ngrok, frontend and backend services started with make start command, just Ctrl + C

